console.clear();

require('dotenv').config({path: '.env'});
const Web3 = require('web3');
const { ethers } = require("ethers");
const urlHandler = require('../../handlers/url.handler');

const contractAbi = `[{"inputs":[{"internalType":"address","name":"_beneficiaryWallet","type":"address"},{"internalType":"address","name":"_buyerfeesigner","type":"address"},{"internalType":"address","name":"_wethAddr","type":"address"},{"internalType":"uint256","name":"_beneficiaryFee","type":"uint256"},{"internalType":"address","name":"_operator","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address[]","name":"benWallets","type":"address[]"},{"indexed":false,"internalType":"uint256[]","name":"benFeeses","type":"uint256[]"}],"name":"AddBeneficiaryWallets","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"Bidder","type":"address"},{"indexed":true,"internalType":"address","name":"Creator","type":"address"},{"indexed":true,"internalType":"address","name":"NFTAddress","type":"address"},{"indexed":false,"internalType":"uint256","name":"NFTTokenID","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"BiddingAmount","type":"uint256"}],"name":"BidNFT","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"sellToken","type":"address"},{"indexed":true,"internalType":"uint256","name":"sellTokenId","type":"uint256"},{"indexed":false,"internalType":"address","name":"owner","type":"address"},{"indexed":false,"internalType":"address","name":"buyToken","type":"address"},{"indexed":false,"internalType":"uint256","name":"buyTokenId","type":"uint256"}],"name":"Cancel","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"Creator","type":"address"},{"indexed":true,"internalType":"address","name":"NFTAddress","type":"address"},{"indexed":true,"internalType":"uint256","name":"TokenID","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"CancelTime","type":"uint256"}],"name":"CancelAuction","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"Creator","type":"address"},{"indexed":true,"internalType":"address","name":"NFTAddress","type":"address"},{"indexed":true,"internalType":"address","name":"BiddngToken","type":"address"},{"indexed":false,"internalType":"uint256","name":"NFTTokenID","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"AuctionEndTime","type":"uint256"}],"name":"CreateAuction","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"Creator","type":"address"},{"indexed":true,"internalType":"address","name":"Bidder","type":"address"},{"indexed":true,"internalType":"address","name":"NFTaddress","type":"address"},{"indexed":false,"internalType":"uint256","name":"ExecuteTime","type":"uint256"}],"name":"ExecuteNFTAuction","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"sellToken","type":"address"},{"indexed":true,"internalType":"uint256","name":"sellTokenId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"sellValue","type":"uint256"},{"indexed":false,"internalType":"address","name":"owner","type":"address"},{"indexed":false,"internalType":"address","name":"buyToken","type":"address"},{"indexed":false,"internalType":"uint256","name":"buyTokenId","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"buyValue","type":"uint256"},{"indexed":false,"internalType":"address","name":"buyer","type":"address"},{"indexed":false,"internalType":"uint256","name":"orderType","type":"uint256"}],"name":"MatchOrder","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"NFTAddr","type":"address"},{"indexed":true,"internalType":"address","name":"Receiver","type":"address"},{"indexed":true,"internalType":"uint256","name":"TokenID","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"supply","type":"uint256"}],"name":"NFTFailSafe","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousOwner","type":"address"},{"indexed":true,"internalType":"address","name":"newOwner","type":"address"}],"name":"OwnershipTransferred","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"account","type":"address"}],"name":"Paused","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"account","type":"address"}],"name":"Unpaused","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"uint256","name":"indexNumber","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"benFee","type":"uint256"}],"name":"UpdateBeneficiaryFeeByIndex","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"previousAddrInThatIndex","type":"address"},{"indexed":true,"internalType":"address","name":"benFeeWallet","type":"address"},{"indexed":true,"internalType":"uint256","name":"index","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"fee","type":"uint256"}],"name":"UpdatedBeneficiaryFeeWallet","type":"event"},{"inputs":[{"internalType":"address","name":"","type":"address"}],"name":"allowedToken","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"name","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"beneficiaryFee","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_NFTowner","type":"address"},{"internalType":"address","name":"_NFTaddr","type":"address"},{"internalType":"uint256","name":"_tokenId","type":"uint256"},{"internalType":"uint256","name":"_newBiddingAmount","type":"uint256"}],"name":"bid","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"biddingDetail","outputs":[{"internalType":"address","name":"NFTowner","type":"address"},{"internalType":"address","name":"bidder","type":"address"},{"internalType":"address","name":"NFTaddress","type":"address"},{"internalType":"address","name":"biddingToken","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"uint64","name":"supply","type":"uint64"},{"internalType":"uint256","name":"lastBiddingAmount","type":"uint256"},{"internalType":"uint256","name":"startingTime","type":"uint256"},{"internalType":"uint256","name":"auctionEndTime","type":"uint256"},{"internalType":"uint8","name":"tokenType","type":"uint8"},{"internalType":"enum bidStatus","name":"status","type":"uint8"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address payable","name":"owner","type":"address"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"sellAsset","type":"tuple"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"buyAsset","type":"tuple"}],"internalType":"struct OrderKey","name":"key","type":"tuple"},{"internalType":"uint256","name":"selling","type":"uint256"},{"internalType":"uint256","name":"buying","type":"uint256"},{"internalType":"uint256","name":"sellerFee","type":"uint256"},{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"uint256","name":"expiryTime","type":"uint256"},{"internalType":"uint256","name":"orderType","type":"uint256"}],"internalType":"struct Order[]","name":"order","type":"tuple[]"},{"components":[{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"internalType":"struct SigStore[]","name":"sig","type":"tuple[]"},{"components":[{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"internalType":"struct SigStore[]","name":"buyerFeeSig","type":"tuple[]"},{"internalType":"uint256[]","name":"royaltyFee","type":"uint256[]"},{"internalType":"address[]","name":"royaltyReceipt","type":"address[]"},{"internalType":"bool[]","name":"isStore","type":"bool[]"},{"internalType":"string[]","name":"uri","type":"string[]"}],"name":"buy","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"buyerFeeSigner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address payable","name":"owner","type":"address"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"sellAsset","type":"tuple"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"buyAsset","type":"tuple"}],"internalType":"struct OrderKey","name":"key","type":"tuple"},{"internalType":"uint256","name":"selling","type":"uint256"},{"internalType":"uint256","name":"buying","type":"uint256"},{"internalType":"uint256","name":"sellerFee","type":"uint256"},{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"uint256","name":"expiryTime","type":"uint256"},{"internalType":"uint256","name":"orderType","type":"uint256"}],"internalType":"struct Order","name":"order","type":"tuple"}],"name":"cancel","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_NFTowner","type":"address"},{"internalType":"address","name":"_NFTaddr","type":"address"},{"internalType":"uint256","name":"_tokenId","type":"uint256"}],"name":"cancelOrder","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"completed","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"internalType":"address","name":"NFTowner","type":"address"},{"internalType":"address","name":"bidder","type":"address"},{"internalType":"address","name":"NFTaddress","type":"address"},{"internalType":"address","name":"biddingToken","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"uint64","name":"supply","type":"uint64"},{"internalType":"uint256","name":"lastBiddingAmount","type":"uint256"},{"internalType":"uint256","name":"startingTime","type":"uint256"},{"internalType":"uint256","name":"auctionEndTime","type":"uint256"},{"internalType":"uint8","name":"tokenType","type":"uint8"},{"internalType":"enum bidStatus","name":"status","type":"uint8"}],"internalType":"struct bidParam","name":"_bid","type":"tuple"}],"name":"createAuction","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_NFTowner","type":"address"},{"internalType":"address","name":"_NFTaddr","type":"address"},{"internalType":"uint256","name":"_tokenId","type":"uint256"},{"internalType":"uint256","name":"_royaltyFee","type":"uint256"},{"internalType":"address","name":"_royaltyReceipt","type":"address"}],"name":"executeBid","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address payable","name":"owner","type":"address"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"sellAsset","type":"tuple"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"buyAsset","type":"tuple"}],"internalType":"struct OrderKey","name":"key","type":"tuple"},{"internalType":"uint256","name":"selling","type":"uint256"},{"internalType":"uint256","name":"buying","type":"uint256"},{"internalType":"uint256","name":"sellerFee","type":"uint256"},{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"uint256","name":"expiryTime","type":"uint256"},{"internalType":"uint256","name":"orderType","type":"uint256"}],"internalType":"struct Order","name":"order","type":"tuple"},{"internalType":"address","name":"buyer","type":"address"},{"internalType":"uint256","name":"buyingAmount","type":"uint256"}],"name":"getBidOrderCompletedKey","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"pure","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address payable","name":"owner","type":"address"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"sellAsset","type":"tuple"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"buyAsset","type":"tuple"}],"internalType":"struct OrderKey","name":"key","type":"tuple"},{"internalType":"uint256","name":"selling","type":"uint256"},{"internalType":"uint256","name":"buying","type":"uint256"},{"internalType":"uint256","name":"sellerFee","type":"uint256"},{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"uint256","name":"expiryTime","type":"uint256"},{"internalType":"uint256","name":"orderType","type":"uint256"}],"internalType":"struct Order","name":"order","type":"tuple"}],"name":"getCompleted","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address payable","name":"owner","type":"address"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"sellAsset","type":"tuple"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"buyAsset","type":"tuple"}],"internalType":"struct OrderKey","name":"key","type":"tuple"},{"internalType":"uint256","name":"selling","type":"uint256"},{"internalType":"uint256","name":"buying","type":"uint256"},{"internalType":"uint256","name":"sellerFee","type":"uint256"},{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"uint256","name":"expiryTime","type":"uint256"},{"internalType":"uint256","name":"orderType","type":"uint256"}],"internalType":"struct Order","name":"order","type":"tuple"}],"name":"getCompletedKey","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"address","name":"receiver","type":"address"},{"internalType":"address","name":"NFTaddress","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"uint256","name":"supply","type":"uint256"},{"internalType":"uint8","name":"tokenType","type":"uint8"}],"name":"incaseNFTStruck","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"name":"isExecuted","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"bytes","name":"","type":"bytes"}],"name":"onERC1155Received","outputs":[{"internalType":"bytes4","name":"","type":"bytes4"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"address","name":"","type":"address"},{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"bytes","name":"","type":"bytes"}],"name":"onERC721Received","outputs":[{"internalType":"bytes4","name":"","type":"bytes4"}],"stateMutability":"pure","type":"function"},{"inputs":[],"name":"operator","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"pause","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"paused","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address payable","name":"owner","type":"address"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"sellAsset","type":"tuple"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"buyAsset","type":"tuple"}],"internalType":"struct OrderKey","name":"key","type":"tuple"},{"internalType":"uint256","name":"selling","type":"uint256"},{"internalType":"uint256","name":"buying","type":"uint256"},{"internalType":"uint256","name":"sellerFee","type":"uint256"},{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"uint256","name":"expiryTime","type":"uint256"},{"internalType":"uint256","name":"orderType","type":"uint256"}],"internalType":"struct Order","name":"order","type":"tuple"},{"internalType":"address","name":"bidder","type":"address"},{"internalType":"uint256","name":"buyingAmount","type":"uint256"}],"name":"prepareBidOrderHash","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"pure","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address payable","name":"owner","type":"address"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"sellAsset","type":"tuple"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"buyAsset","type":"tuple"}],"internalType":"struct OrderKey","name":"key","type":"tuple"},{"internalType":"uint256","name":"selling","type":"uint256"},{"internalType":"uint256","name":"buying","type":"uint256"},{"internalType":"uint256","name":"sellerFee","type":"uint256"},{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"uint256","name":"expiryTime","type":"uint256"},{"internalType":"uint256","name":"orderType","type":"uint256"}],"internalType":"struct Order","name":"order","type":"tuple"},{"internalType":"uint256","name":"fee","type":"uint256"},{"internalType":"address","name":"royaltyReceipt","type":"address"}],"name":"prepareBuyerFeeMessage","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"pure","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address payable","name":"owner","type":"address"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"sellAsset","type":"tuple"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"buyAsset","type":"tuple"}],"internalType":"struct OrderKey","name":"key","type":"tuple"},{"internalType":"uint256","name":"selling","type":"uint256"},{"internalType":"uint256","name":"buying","type":"uint256"},{"internalType":"uint256","name":"sellerFee","type":"uint256"},{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"uint256","name":"expiryTime","type":"uint256"},{"internalType":"uint256","name":"orderType","type":"uint256"}],"internalType":"struct Order","name":"order","type":"tuple"}],"name":"prepareOrderHash","outputs":[{"internalType":"bytes32","name":"","type":"bytes32"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"recoverLeftOverEth","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"contract IERC20","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"recoverLeftOverToken","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"renounceOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"symbol","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address payable","name":"owner","type":"address"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"sellAsset","type":"tuple"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"buyAsset","type":"tuple"}],"internalType":"struct OrderKey","name":"key","type":"tuple"},{"internalType":"uint256","name":"selling","type":"uint256"},{"internalType":"uint256","name":"buying","type":"uint256"},{"internalType":"uint256","name":"sellerFee","type":"uint256"},{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"uint256","name":"expiryTime","type":"uint256"},{"internalType":"uint256","name":"orderType","type":"uint256"}],"internalType":"struct Order[]","name":"order","type":"tuple[]"},{"components":[{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"internalType":"struct SigStore[]","name":"buyerFeeSig","type":"tuple[]"},{"internalType":"uint256[]","name":"royaltyFee","type":"uint256[]"},{"internalType":"address[]","name":"royaltyReceipt","type":"address[]"},{"internalType":"bool[]","name":"isStore","type":"bool[]"},{"internalType":"string[]","name":"uri","type":"string[]"}],"name":"sell","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"newBeneficaryFee","type":"uint256"}],"name":"setBeneficaryFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"newBuyerFeeSigner","type":"address"}],"name":"setBuyerFeeSigner","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"_newOperator","type":"address"}],"name":"setOperator","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"newsymbol","type":"uint256"}],"name":"setsymbol","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"bool","name":"status","type":"bool"}],"name":"setTokenStatus","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"bytes32","name":"hash","type":"bytes32"},{"components":[{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"internalType":"struct SigStore","name":"sig","type":"tuple"}],"name":"toEthSignedMessageHash","outputs":[{"internalType":"address","name":"signer","type":"address"}],"stateMutability":"pure","type":"function"},{"inputs":[{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"royaltyPcent","type":"uint256"}],"name":"transferFeeView","outputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"newOwner","type":"address"}],"name":"transferOwnership","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"unpause","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address payable","name":"owner","type":"address"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"sellAsset","type":"tuple"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"buyAsset","type":"tuple"}],"internalType":"struct OrderKey","name":"key","type":"tuple"},{"internalType":"uint256","name":"selling","type":"uint256"},{"internalType":"uint256","name":"buying","type":"uint256"},{"internalType":"uint256","name":"sellerFee","type":"uint256"},{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"uint256","name":"expiryTime","type":"uint256"},{"internalType":"uint256","name":"orderType","type":"uint256"}],"internalType":"struct Order","name":"order","type":"tuple"},{"internalType":"uint256","name":"buyerFee","type":"uint256"},{"internalType":"address","name":"royaltyReceipt","type":"address"},{"components":[{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"internalType":"struct SigStore","name":"sig","type":"tuple"}],"name":"validateBuyerFeeSigView","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"pure","type":"function"},{"inputs":[{"components":[{"components":[{"internalType":"address payable","name":"owner","type":"address"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"sellAsset","type":"tuple"},{"components":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"tokenId","type":"uint256"},{"internalType":"enum AssetType","name":"assetType","type":"uint8"}],"internalType":"struct Asset","name":"buyAsset","type":"tuple"}],"internalType":"struct OrderKey","name":"key","type":"tuple"},{"internalType":"uint256","name":"selling","type":"uint256"},{"internalType":"uint256","name":"buying","type":"uint256"},{"internalType":"uint256","name":"sellerFee","type":"uint256"},{"internalType":"uint256","name":"salt","type":"uint256"},{"internalType":"uint256","name":"expiryTime","type":"uint256"},{"internalType":"uint256","name":"orderType","type":"uint256"}],"internalType":"struct Order","name":"order","type":"tuple"},{"components":[{"internalType":"uint8","name":"v","type":"uint8"},{"internalType":"bytes32","name":"r","type":"bytes32"},{"internalType":"bytes32","name":"s","type":"bytes32"}],"internalType":"struct SigStore","name":"sig","type":"tuple"}],"name":"validateOrderSignatureView","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"weth","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"stateMutability":"payable","type":"receive"}]`

const testnetContractId = "0x9D15dB89026eCD2E422479399816f462B8a053b9"; //NFT CONTRACT ON POLYGON
const testnetPrivateKey = process.env.MUMBAI_TESTNET_OPERATOR_PRIVATE_KEY;

const mainnetContractId = "0xd3a0c7218F77d943d92Bc9355dF1bb7848642d6F" //NFT CONTRACT ON MAINNET
const mainnetPrivateKey = process.env.MAINNET_OPERATOR_PRIVATE_KEY;


describe('[Web3] Call Contract Method', () => {

    test('Testnet | Should fetch name from nft contract', async () => {
        // Arrange
        const web3 = new Web3(urlHandler.getPolygonMumbaiTestnet());
        const contractJson = await JSON.parse(contractAbi);
        const sampleContract =  new web3.eth.Contract(contractJson, testnetContractId);

        // Act
        let result = await sampleContract.methods.name().call();

        // Assert
        expect(result).toBeDefined();
    });

    test('Testnet | Should fetch symbol from nft contract', async () => {
        // Arrange
        const web3 = new Web3(urlHandler.getPolygonMumbaiTestnet());
        const contractJson = await JSON.parse(contractAbi);
        const sampleContract =  new web3.eth.Contract(contractJson, testnetContractId);

        // Act
        let result = await sampleContract.methods.symbol().call();

        // Assert
        expect(result).toBeDefined();
    });

    test('Mainnet | Should fetch name from nft contract', async () => {
        // Arrange
        const web3 = new Web3(urlHandler.getPolygonMainnet());
        const contractJson = await JSON.parse(contractAbi);
        const sampleContract =  new web3.eth.Contract(contractJson, mainnetContractId);

        // Act
        let result = await sampleContract.methods.name().call();

        // Assert
        expect(result).toBeDefined();
    });

    test('Mainnet | Should fetch symbol from nft contract', async () => {
        // Arrange
        const web3 = new Web3(urlHandler.getPolygonMainnet());
        const contractJson = await JSON.parse(contractAbi);
        const sampleContract =  new web3.eth.Contract(contractJson, mainnetContractId);

        // Act
        let result = await sampleContract.methods.symbol().call();

        // Assert
        expect(result).toBeDefined();
    });

});

describe('[Ethers] Call Contract Method', () => {

    test('Testnet | Should fetch name from nft contract', async () => {
        // Arrange
        const provider = new ethers.providers.JsonRpcProvider(urlHandler.getPolygonMumbaiTestnet());
        const signer = new ethers.Wallet(testnetPrivateKey, provider);
        const sampleContract = new ethers.Contract(testnetContractId, contractAbi, signer)

        // Act
        let result = await sampleContract.name();

        // Assert
        expect(result).toBeDefined();
    });

    test('Testnet | Should fetch symbol from nft contract', async () => {
        // Arrange
        const provider = new ethers.providers.JsonRpcProvider(urlHandler.getPolygonMumbaiTestnet());
        const signer = new ethers.Wallet(testnetPrivateKey, provider);
        const sampleContract = new ethers.Contract(testnetContractId, contractAbi, signer)

        // Act
        let result = await sampleContract.symbol();

        // Assert
        expect(result).toBeDefined();
    });

    test('Mainnet | Should fetch name from nft contract', async () => {
        // Arrange
        const provider = new ethers.providers.JsonRpcProvider(urlHandler.getPolygonMainnet());
        const signer = new ethers.Wallet(mainnetPrivateKey, provider);
        const sampleContract = new ethers.Contract(mainnetContractId, contractAbi, signer)

        // Act
        let result = await sampleContract.name();

        // Assert
        expect(result).toBeDefined();
    });

    test('Mainnet | Should fetch symbol from nft contract', async () => {
        // Arrange
        const provider = new ethers.providers.JsonRpcProvider(urlHandler.getPolygonMainnet());
        const signer = new ethers.Wallet(mainnetPrivateKey, provider);
        const sampleContract = new ethers.Contract(mainnetContractId, contractAbi, signer)

        // Act
        let result = await sampleContract.symbol();

        // Assert
        expect(result).toBeDefined();
    });
});
